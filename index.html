<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>æ™ºèƒ½æ‰‹æœºæ¨¡æ‹Ÿå™¨</title>
    <style>
        :root {
            --primary: #007aff;
            --secondary: #5856d6;
            --success: #34c759;
            --warning: #ff9500;
            --danger: #ff3b30;
            --bg: #f2f2f7;
            --card: #ffffff;
            --text: #000000;
            --text-secondary: #8e8e93;
            --border: #c7c7cc;
            --radius: 12px;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --dark-bg: #000000;
            --dark-card: #1c1c1e;
            --dark-text: #ffffff;
            --dark-border: #38383a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a2980 0%, #26d0ce 100%);
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }

        /* æ‰‹æœºå®¹å™¨ - å…¨å±æ— è¾¹æ¡† */
        .phone {
            width: 100%;
            height: 100%;
            background: var(--bg);
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s ease;
        }

        /* æš—è‰²æ¨¡å¼ */
        .phone.dark-mode {
            --bg: var(--dark-bg);
            --card: var(--dark-card);
            --text: var(--dark-text);
            --text-secondary: #8e8e93;
            --border: var(--dark-border);
        }

        /* çŠ¶æ€æ  */
        .status-bar {
            height: 44px;
            background: rgba(0,0,0,0.95);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            position: relative;
            flex-shrink: 0;
            z-index: 100;
        }

        .dark-mode .status-bar {
            background: rgba(28,28,30,0.95);
        }

        .battery {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .battery-level {
            width: 24px;
            height: 12px;
            border: 1px solid white;
            border-radius: 2px;
            position: relative;
        }

        .battery-level::after {
            content: '';
            position: absolute;
            right: -3px;
            top: 3px;
            width: 2px;
            height: 6px;
            background: white;
        }

        .battery-fill {
            height: 100%;
            width: 80%;
            background: white;
            border-radius: 1px;
            transition: width 0.3s ease;
        }

        /* æ‰€æœ‰å±å¹•çš„é€šç”¨æ ·å¼ */
        .screen {
            display: none;
            flex: 1;
            flex-direction: column;
            background: var(--bg);
            position: relative;
            overflow: hidden;
        }

        .screen.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        /* å±å¹•å¤´éƒ¨é€šç”¨æ ·å¼ */
        .screen-header {
            padding: 15px;
            background: var(--card);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 15px;
            flex-shrink: 0;
        }

        .back-btn {
            font-size: 24px;
            color: var(--primary);
            cursor: pointer;
            padding: 8px;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
        }

        .screen-title {
            flex: 1;
            font-size: 20px;
            font-weight: 600;
        }

        /* ä¸»å±å¹• */
        .home-screen {
            display: flex;
            flex: 1;
            flex-direction: column;
            background: var(--bg);
            position: relative;
        }

        /* åº”ç”¨ç½‘æ ¼ - ä¿®å¤æ»‘åŠ¨é—®é¢˜ */
        .app-grid {
            padding: 25px 20px 100px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            height: 100%;
            flex: 1;
        }

        .app {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: transform 0.2s;
            min-height: 80px;
            touch-action: manipulation;
            user-select: none;
        }

        .app:active {
            transform: scale(0.95);
        }

        .app-icon {
            width: 65px;
            height: 65px;
            border-radius: var(--radius);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            box-shadow: var(--shadow);
            pointer-events: none;
        }

        .app-name {
            font-size: 12px;
            color: var(--text);
            text-align: center;
            font-weight: 500;
            pointer-events: none;
        }

        /* èŠå¤©ç•Œé¢ */
        .chat-header {
            padding: 10px 15px;
        }

        .chat-title {
            font-size: 18px;
        }

        .chat-status {
            font-size: 12px;
            color: var(--success);
        }

        .messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
            -webkit-overflow-scrolling: touch;
        }

        .message {
            max-width: 80%;
            padding: 12px 15px;
            border-radius: 18px;
            line-height: 1.4;
            position: relative;
            word-wrap: break-word;
        }

        .message.received {
            background: var(--card);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            box-shadow: var(--shadow);
        }

        .message.sent {
            background: var(--primary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
            box-shadow: var(--shadow);
        }

        .message-time {
            font-size: 10px;
            color: var(--text-secondary);
            margin-top: 5px;
            text-align: right;
        }

        .input-area {
            padding: 15px;
            background: var(--card);
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
            align-items: center;
            flex-shrink: 0;
        }

        .message-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 16px;
            background: var(--bg);
            color: var(--text);
            -webkit-appearance: none;
        }

        .send-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* è´­ç‰©ç•Œé¢ */
        .shop-header {
            padding: 15px;
        }

        .cart-btn {
            position: relative;
            cursor: pointer;
            padding: 10px;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .products {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            -webkit-overflow-scrolling: touch;
        }

        .product {
            background: var(--card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.2s;
            cursor: pointer;
        }

        .product:active {
            transform: scale(0.98);
        }

        .product-img {
            width: 100%;
            height: 120px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 40px;
        }

        .product-info {
            padding: 12px;
        }

        .product-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
            color: var(--text);
        }

        .product-price {
            color: var(--primary);
            font-weight: bold;
            font-size: 16px;
        }

        .add-to-cart {
            margin-top: 10px;
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            min-height: 44px;
        }

        /* è®°è´¦ç•Œé¢ */
        .account-header {
            padding: 20px 15px;
            background: var(--primary);
            color: white;
            flex-shrink: 0;
        }

        .balance {
            font-size: 36px;
            font-weight: 300;
            text-align: center;
            margin: 10px 0;
        }

        .balance-label {
            font-size: 14px;
            opacity: 0.9;
            text-align: center;
        }

        .account-actions {
            padding: 15px;
            background: var(--card);
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: var(--radius);
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            min-height: 44px;
        }

        .action-btn:active {
            background: var(--border);
        }

        .action-btn.income {
            color: var(--success);
        }

        .action-btn.expense {
            color: var(--danger);
        }

        .transactions {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .transaction {
            background: var(--card);
            padding: 12px;
            border-radius: var(--radius);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .transaction-info h4 {
            font-size: 14px;
            margin-bottom: 4px;
            color: var(--text);
        }

        .transaction-info span {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .transaction-amount {
            font-weight: bold;
            font-size: 16px;
        }

        .transaction-amount.income {
            color: var(--success);
        }

        .transaction-amount.expense {
            color: var(--danger);
        }

        /* ä¸–ç•Œä¹¦ç•Œé¢ */
        .book-header {
            padding: 15px;
        }

        .add-book-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .books-list {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            -webkit-overflow-scrolling: touch;
        }

        .book-item {
            background: var(--card);
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: var(--shadow);
            transition: transform 0.2s;
            cursor: pointer;
        }

        .book-item:active {
            transform: scale(0.98);
        }

        .book-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            margin-bottom: 12px;
        }

        .book-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 16px;
            color: var(--text);
        }

        .book-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* è®¾ç½®ç•Œé¢ */
        .settings-container {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 80px;
        }

        .settings-section {
            background: var(--card);
            margin: 15px;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .settings-section-title {
            padding: 15px;
            font-size: 18px;
            font-weight: 600;
            color: var(--text);
            border-bottom: 1px solid var(--border);
            background: rgba(0,0,0,0.02);
        }

        .dark-mode .settings-section-title {
            background: rgba(255,255,255,0.05);
        }

        .settings-item {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item:active {
            background-color: rgba(0,0,0,0.05);
        }

        .dark-mode .settings-item:active {
            background-color: rgba(255,255,255,0.05);
        }

        .settings-item-label {
            display: flex;
            flex-direction: column;
            gap: 4px;
            flex: 1;
        }

        .settings-item-name {
            font-size: 16px;
            font-weight: 500;
            color: var(--text);
        }

        .settings-item-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .settings-item-value {
            font-size: 14px;
            color: var(--text-secondary);
            margin-left: 10px;
        }

        .settings-input {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg);
            color: var(--text);
            font-size: 14px;
            width: 100%;
            margin-top: 8px;
        }

        .settings-select {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg);
            color: var(--text);
            font-size: 14px;
            width: 100%;
            margin-top: 8px;
        }

        .settings-textarea {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg);
            color: var(--text);
            font-size: 14px;
            width: 100%;
            margin-top: 8px;
            resize: vertical;
            min-height: 80px;
        }

        .settings-toggle {
            position: relative;
            width: 52px;
            height: 32px;
        }

        .settings-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .settings-toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .settings-toggle-slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        .settings-toggle input:checked + .settings-toggle-slider {
            background-color: var(--primary);
        }

        .settings-toggle input:checked + .settings-toggle-slider:before {
            transform: translateX(20px);
        }

        .settings-button {
            padding: 12px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: opacity 0.2s;
        }

        .settings-button:active {
            opacity: 0.8;
        }

        .settings-button.secondary {
            background: var(--bg);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .settings-button.danger {
            background: var(--danger);
        }

        .settings-button.success {
            background: var(--success);
        }

        .settings-button.warning {
            background: var(--warning);
        }

        .settings-subsection {
            padding: 15px;
            border-top: 1px solid var(--border);
        }

        .settings-row {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .settings-row .settings-button {
            flex: 1;
            margin-top: 0;
        }

        .api-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .api-status.connected {
            background-color: var(--success);
        }

        .api-status.disconnected {
            background-color: var(--danger);
        }

        .api-status.connecting {
            background-color: var(--warning);
            animation: pulse 1.5s infinite;
        }

        .voice-preview {
            padding: 10px;
            background: var(--bg);
            border-radius: 8px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .voice-preview:active {
            opacity: 0.8;
        }

        .image-preview {
            width: 100%;
            height: 150px;
            background: var(--bg);
            border-radius: 8px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .backup-status {
            font-size: 12px;
            padding: 6px 10px;
            border-radius: 6px;
            margin-left: 10px;
        }

        .backup-status.success {
            background: rgba(52, 199, 89, 0.2);
            color: var(--success);
        }

        .backup-status.warning {
            background: rgba(255, 149, 0, 0.2);
            color: var(--warning);
        }

        .backup-status.error {
            background: rgba(255, 59, 48, 0.2);
            color: var(--danger);
        }

        /* åº•éƒ¨å¯¼èˆª */
        .bottom-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 15px;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .dark-mode .bottom-nav {
            background: rgba(28,28,30,0.95);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: background 0.2s;
            min-width: 44px;
            min-height: 44px;
            justify-content: center;
            user-select: none;
        }

        .nav-item:active {
            background: rgba(0,0,0,0.05);
        }

        .dark-mode .nav-item:active {
            background: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            background: rgba(0,122,255,0.1);
        }

        .nav-icon {
            font-size: 20px;
            pointer-events: none;
        }

        .nav-name {
            font-size: 10px;
            pointer-events: none;
        }

        /* å¯¹è¯æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: var(--card);
            border-radius: var(--radius);
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            padding: 15px;
            background: var(--primary);
            color: white;
            font-size: 18px;
            font-weight: 600;
        }

        .modal-body {
            padding: 15px;
            max-height: 60vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-footer {
            padding: 15px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            min-height: 44px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-secondary {
            background: var(--bg);
            color: var(--text);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        /* åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* ç¡®ä¿è¾“å…¥å…ƒç´ åœ¨iOSä¸Šçœ‹èµ·æ¥æ­£å¸¸ */
        input, textarea, select {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
        }

        /* ç¡®ä¿æŒ‰é’®åœ¨iOSä¸Šæœ‰æ­£ç¡®çš„å…‰æ ‡ */
        button {
            cursor: pointer;
        }

        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* é€šçŸ¥ */
        .notification {
            position: fixed;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card);
            color: var(--text);
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10000;
            animation: fadeIn 0.3s, fadeOut 0.3s 2.7s forwards;
            max-width: 80%;
            text-align: center;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .notification.error {
            border-left: 4px solid var(--danger);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        .notification.info {
            border-left: 4px solid var(--primary);
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* æ–‡ä»¶ä¸Šä¼ æ ·å¼ */
        .file-upload {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        /* è¿›åº¦æ¡ */
        .progress-bar {
            width: 100%;
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-bar-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="phone" id="phone">
        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="time">9:41</div>
            <div class="battery">
                <span>80%</span>
                <div class="battery-level">
                    <div class="battery-fill"></div>
                </div>
            </div>
        </div>

        <!-- ä¸»å±å¹• -->
        <div class="screen active" id="home-screen">
            <div class="app-grid">
                <div class="app" data-app="chat">
                    <div class="app-icon">ğŸ¤–</div>
                    <div class="app-name">AIèŠå¤©</div>
                </div>
                <div class="app" data-app="shop">
                    <div class="app-icon">ğŸ›ï¸</div>
                    <div class="app-name">è´­ç‰©ä¸­å¿ƒ</div>
                </div>
                <div class="app" data-app="account">
                    <div class="app-icon">ğŸ’°</div>
                    <div class="app-name">è®°è´¦</div>
                </div>
                <div class="app" data-app="book">
                    <div class="app-icon">ğŸ“š</div>
                    <div class="app-name">ä¸–ç•Œä¹¦</div>
                </div>
                <div class="app" data-app="settings">
                    <div class="app-icon">âš™ï¸</div>
                    <div class="app-name">è®¾ç½®</div>
                </div>
                <div class="app" data-app="music">
                    <div class="app-icon">ğŸµ</div>
                    <div class="app-name">éŸ³ä¹</div>
                </div>
                <div class="app" data-app="weather">
                    <div class="app-icon">â›…</div>
                    <div class="app-name">å¤©æ°”</div>
                </div>
                <div class="app" data-app="calculator">
                    <div class="app-icon">ğŸ§®</div>
                    <div class="app-name">è®¡ç®—å™¨</div>
                </div>
                <div class="app" data-app="notes">
                    <div class="app-icon">ğŸ“</div>
                    <div class="app-name">å¤‡å¿˜å½•</div>
                </div>
                <div class="app" data-app="camera">
                    <div class="app-icon">ğŸ“·</div>
                    <div class="app-name">ç›¸æœº</div>
                </div>
                <div class="app" data-app="gallery">
                    <div class="app-icon">ğŸ–¼ï¸</div>
                    <div class="app-name">ç›¸å†Œ</div>
                </div>
                <div class="app" data-app="files">
                    <div class="app-icon">ğŸ“</div>
                    <div class="app-name">æ–‡ä»¶</div>
                </div>
            </div>
        </div>

        <!-- AIèŠå¤©å±å¹• -->
        <div class="screen" id="chat-screen">
            <div class="screen-header chat-header">
                <div class="back-btn" onclick="goHome()">â†</div>
                <div class="chat-info">
                    <div class="chat-title">AIåŠ©æ‰‹</div>
                    <div class="chat-status">åœ¨çº¿</div>
                </div>
            </div>
            
            <div class="messages" id="chat-messages">
                <div class="message received">
                    ä½ å¥½ï¼æˆ‘æ˜¯AIåŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨çš„å—ï¼Ÿ
                    <div class="message-time">9:41</div>
                </div>
                <div class="message sent">
                    ä»‹ç»ä¸€ä¸‹æ‰‹æœºæ¨¡æ‹Ÿå™¨åŠŸèƒ½
                    <div class="message-time">9:42</div>
                </div>
                <div class="message received">
                    æœ¬æ¨¡æ‹Ÿå™¨åŒ…å«AIèŠå¤©ã€è´­ç‰©ã€è®°è´¦ã€ä¸–ç•Œä¹¦ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œé‡‡ç”¨å“åº”å¼è®¾è®¡ï¼Œé€‚é…ç§»åŠ¨ç«¯ï¼Œå¯åœ¨Koderä¸­è¿è¡Œæ¼”ç¤ºã€‚
                    <div class="message-time">9:42</div>
                </div>
            </div>
            
            <div class="input-area">
                <input type="text" class="message-input" id="message-input" placeholder="è¾“å…¥æ¶ˆæ¯..." onkeypress="sendMessageOnEnter(event)">
                <button class="send-btn" onclick="sendMessage()">â†‘</button>
            </div>
        </div>

        <!-- è´­ç‰©å±å¹• -->
        <div class="screen" id="shop-screen">
            <div class="screen-header shop-header">
                <div class="back-btn" onclick="goHome()">â†</div>
                <div class="screen-title">è´­ç‰©ä¸­å¿ƒ</div>
                <div class="cart-btn" onclick="viewCart()">
                    ğŸ›’
                    <span class="cart-count" id="cart-count">0</span>
                </div>
            </div>
            
            <div class="products" id="products">
                <!-- äº§å“å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>
        </div>

        <!-- è®°è´¦å±å¹• -->
        <div class="screen" id="account-screen">
            <div class="account-header">
                <div class="back-btn" onclick="goHome()">â†</div>
                <div class="balance">Â¥ <span id="balance">5,280.50</span></div>
                <div class="balance-label">å½“å‰ä½™é¢</div>
            </div>
            
            <div class="account-actions">
                <button class="action-btn income" onclick="addTransaction('income')">
                    <span style="font-size: 20px;">â†‘</span>
                    æ”¶å…¥
                </button>
                <button class="action-btn expense" onclick="addTransaction('expense')">
                    <span style="font-size: 20px;">â†“</span>
                    æ”¯å‡º
                </button>
            </div>
            
            <div class="transactions" id="transactions">
                <!-- äº¤æ˜“è®°å½•é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>
        </div>

        <!-- ä¸–ç•Œä¹¦å±å¹• -->
        <div class="screen" id="book-screen">
            <div class="screen-header book-header">
                <div class="back-btn" onclick="goHome()">â†</div>
                <div class="screen-title">ä¸–ç•Œä¹¦</div>
                <button class="add-book-btn" onclick="addBook()">+</button>
            </div>
            
            <div class="books-list" id="books-list">
                <!-- ä¹¦ç±é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>
        </div>

        <!-- è®¾ç½®å±å¹• -->
        <div class="screen" id="settings-screen">
            <div class="screen-header">
                <div class="back-btn" onclick="goHome()">â†</div>
                <div class="screen-title">è®¾ç½®</div>
            </div>
            
            <div class="settings-container" id="settings-container">
                <!-- è®¾ç½®å†…å®¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- åº•éƒ¨å¯¼èˆª -->
        <div class="bottom-nav">
            <div class="nav-item active" data-nav="home">
                <div class="nav-icon">ğŸ </div>
                <div class="nav-name">ä¸»é¡µ</div>
            </div>
            <div class="nav-item" data-nav="chat">
                <div class="nav-icon">ğŸ¤–</div>
                <div class="nav-name">AI</div>
            </div>
            <div class="nav-item" data-nav="shop">
                <div class="nav-icon">ğŸ›ï¸</div>
                <div class="nav-name">è´­ç‰©</div>
            </div>
            <div class="nav-item" data-nav="account">
                <div class="nav-icon">ğŸ’°</div>
                <div class="nav-name">è®°è´¦</div>
            </div>
            <div class="nav-item" data-nav="settings">
                <div class="nav-icon">âš™ï¸</div>
                <div class="nav-name">è®¾ç½®</div>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ äº¤æ˜“æ¨¡æ€æ¡† -->
    <div class="modal" id="transaction-modal">
        <div class="modal-content">
            <div class="modal-header">æ·»åŠ äº¤æ˜“</div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">ç±»å‹</label>
                    <select id="transaction-type" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="income">æ”¶å…¥</option>
                        <option value="expense">æ”¯å‡º</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">é‡‘é¢</label>
                    <input type="number" id="transaction-amount" placeholder="0.00" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">æè¿°</label>
                    <input type="text" id="transaction-desc" placeholder="è¯·è¾“å…¥æè¿°" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveTransaction()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- è´­ç‰©è½¦æ¨¡æ€æ¡† -->
    <div class="modal" id="cart-modal">
        <div class="modal-content">
            <div class="modal-header">è´­ç‰©è½¦</div>
            <div class="modal-body" id="cart-items">
                <!-- è´­ç‰©è½¦å†…å®¹é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
                <p style="text-align: center; color: var(--text-secondary); padding: 20px;">è´­ç‰©è½¦æ˜¯ç©ºçš„</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">ç»§ç»­è´­ç‰©</button>
                <button class="btn btn-primary" onclick="checkout()">ç»“ç®—</button>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ ä¹¦ç±æ¨¡æ€æ¡† -->
    <div class="modal" id="book-modal">
        <div class="modal-content">
            <div class="modal-header">æ·»åŠ ä¸–ç•Œä¹¦</div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">ä¹¦å</label>
                    <input type="text" id="book-name" placeholder="è¯·è¾“å…¥ä¹¦å" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">æè¿°</label>
                    <textarea id="book-desc" placeholder="è¯·è¾“å…¥æè¿°" rows="3" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px; resize: vertical;"></textarea>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">åˆ†ç±»</label>
                    <select id="book-category" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="å°è¯´">å°è¯´</option>
                        <option value="ç§‘æŠ€">ç§‘æŠ€</option>
                        <option value="å†å²">å†å²</option>
                        <option value="æ•™è‚²">æ•™è‚²</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveBook()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- APIé…ç½®æ¨¡æ€æ¡† -->
    <div class="modal" id="api-modal">
        <div class="modal-content">
            <div class="modal-header">APIé…ç½®</div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">è¿æ¥ç±»å‹</label>
                    <select id="api-type" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="direct">ç›´è¿</option>
                        <option value="cli">CLIä»£ç†</option>
                        <option value="reverse-proxy">åå‘ä»£ç†</option>
                        <option value="custom">è‡ªå®šä¹‰</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">APIç«¯ç‚¹</label>
                    <input type="text" id="api-endpoint" placeholder="https://api.example.com/v1" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">APIå¯†é’¥</label>
                    <input type="password" id="api-key" placeholder="è¾“å…¥APIå¯†é’¥" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</label>
                    <input type="number" id="api-timeout" value="30" min="5" max="300" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">é‡è¯•æ¬¡æ•°</label>
                    <input type="number" id="api-retry" value="3" min="0" max="10" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div id="api-status-container" style="margin-top: 15px; padding: 10px; border-radius: 8px; background: var(--bg); text-align: center;">
                    <div id="api-status-text">çŠ¶æ€ï¼šæœªè¿æ¥</div>
                    <div class="progress-bar" style="margin-top: 10px;">
                        <div class="progress-bar-fill" id="api-progress" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-success" onclick="testApiConnection()">æµ‹è¯•è¿æ¥</button>
                <button class="btn btn-primary" onclick="saveApiConfig()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- TTSè¯­éŸ³é…ç½®æ¨¡æ€æ¡† -->
    <div class="modal" id="tts-modal">
        <div class="modal-content">
            <div class="modal-header">TTSè¯­éŸ³é…ç½®</div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">è¯­éŸ³æœåŠ¡æä¾›å•†</label>
                    <select id="tts-provider" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="minimax">Minimax</option>
                        <option value="azure">Azure Cognitive Services</option>
                        <option value="google">Google Cloud TTS</option>
                        <option value="amazon">Amazon Polly</option>
                        <option value="local">æœ¬åœ°TTSå¼•æ“</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">APIå¯†é’¥</label>
                    <input type="password" id="tts-api-key" placeholder="è¾“å…¥TTS APIå¯†é’¥" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">è¯­éŸ³æ¨¡å‹</label>
                    <select id="tts-model" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="female-1">å¥³æ€§å£°éŸ³ 1</option>
                        <option value="female-2">å¥³æ€§å£°éŸ³ 2</option>
                        <option value="male-1">ç”·æ€§å£°éŸ³ 1</option>
                        <option value="male-2">ç”·æ€§å£°éŸ³ 2</option>
                        <option value="child">å„¿ç«¥å£°éŸ³</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">è¯­é€Ÿ</label>
                    <input type="range" id="tts-speed" min="0.5" max="2.0" step="0.1" value="1.0" style="width: 100%;">
                    <div style="text-align: center; margin-top: 5px; font-size: 14px; color: var(--text-secondary);">
                        å½“å‰å€¼: <span id="tts-speed-value">1.0</span>
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">éŸ³è°ƒ</label>
                    <input type="range" id="tts-pitch" min="0.5" max="2.0" step="0.1" value="1.0" style="width: 100%;">
                    <div style="text-align: center; margin-top: 5px; font-size: 14px; color: var(--text-secondary);">
                        å½“å‰å€¼: <span id="tts-pitch-value">1.0</span>
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">æµ‹è¯•æ–‡æœ¬</label>
                    <textarea id="tts-test-text" placeholder="è¾“å…¥è¦æµ‹è¯•çš„æ–‡æœ¬" rows="2" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­éŸ³æµ‹è¯•ã€‚</textarea>
                </div>
                <div class="voice-preview" onclick="testTTS()">
                    <span>ğŸ¤ ç‚¹å‡»æµ‹è¯•è¯­éŸ³</span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveTTSConfig()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- AIæ–‡ç”Ÿå›¾é…ç½®æ¨¡æ€æ¡† -->
    <div class="modal" id="image-gen-modal">
        <div class="modal-content">
            <div class="modal-header">AIæ–‡ç”Ÿå›¾é…ç½®</div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">å›¾åƒç”ŸæˆæœåŠ¡</label>
                    <select id="image-gen-provider" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="noval-ai">Noval AI</option>
                        <option value="nano-banana">Nano Banana</option>
                        <option value="stable-diffusion">Stable Diffusion</option>
                        <option value="dall-e">DALL-E</option>
                        <option value="midjourney">Midjourney (API)</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">APIå¯†é’¥</label>
                    <input type="password" id="image-gen-api-key" placeholder="è¾“å…¥å›¾åƒç”ŸæˆAPIå¯†é’¥" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">é»˜è®¤åˆ†è¾¨ç‡</label>
                    <select id="image-gen-resolution" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="512x512">512x512</option>
                        <option value="768x768">768x768</option>
                        <option value="1024x1024">1024x1024</option>
                        <option value="512x768">512x768</option>
                        <option value="768x1024">768x1024</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">ç”Ÿæˆæ•°é‡</label>
                    <input type="number" id="image-gen-count" min="1" max="10" value="1" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">é£æ ¼é¢„è®¾</label>
                    <select id="image-gen-style" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="realistic">å†™å®é£æ ¼</option>
                        <option value="anime">åŠ¨æ¼«é£æ ¼</option>
                        <option value="digital-art">æ•°å­—è‰ºæœ¯</option>
                        <option value="photographic">æ‘„å½±é£æ ¼</option>
                        <option value="fantasy">å¥‡å¹»é£æ ¼</option>
                        <option value="cyberpunk">èµ›åšæœ‹å…‹</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">æµ‹è¯•æç¤ºè¯</label>
                    <textarea id="image-gen-test-prompt" placeholder="è¾“å…¥æµ‹è¯•æç¤ºè¯" rows="2" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">ä¸€åªå¯çˆ±çš„çŒ«åœ¨èŠ±å›­é‡Œç©è€</textarea>
                </div>
                <div class="image-preview" id="image-gen-preview">
                    <div style="text-align: center; color: var(--text-secondary);">
                        <div>ğŸ–¼ï¸</div>
                        <div>ç”Ÿæˆçš„å›¾åƒå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
                    </div>
                </div>
                <div class="settings-row">
                    <button class="settings-button secondary" onclick="clearImagePreview()">æ¸…é™¤é¢„è§ˆ</button>
                    <button class="settings-button success" onclick="testImageGeneration()">æµ‹è¯•ç”Ÿæˆ</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveImageGenConfig()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- å¤‡ä»½é…ç½®æ¨¡æ€æ¡† -->
    <div class="modal" id="backup-modal">
        <div class="modal-content">
            <div class="modal-header">å¤‡ä»½é…ç½®</div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">å¤‡ä»½æœåŠ¡</label>
                    <select id="backup-service" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="github">GitHub</option>
                        <option value="gitlab">GitLab</option>
                        <option value="dropbox">Dropbox</option>
                        <option value="google-drive">Google Drive</option>
                        <option value="local">æœ¬åœ°å¤‡ä»½</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">ä»“åº“/æ–‡ä»¶å¤¹åç§°</label>
                    <input type="text" id="backup-repo" placeholder="user/repo æˆ– æ–‡ä»¶å¤¹è·¯å¾„" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">è®¿é—®ä»¤ç‰Œ/å¯†é’¥</label>
                    <input type="password" id="backup-token" placeholder="è¾“å…¥è®¿é—®ä»¤ç‰Œ" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">å¤‡ä»½é¢‘ç‡</label>
                    <select id="backup-frequency" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 16px;">
                        <option value="manual">æ‰‹åŠ¨</option>
                        <option value="daily">æ¯æ—¥</option>
                        <option value="weekly">æ¯å‘¨</option>
                        <option value="monthly">æ¯æœˆ</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">åŒ…å«çš„æ•°æ®</label>
                    <div style="margin-top: 5px;">
                        <label style="display: flex; align-items: center; margin-bottom: 8px;">
                            <input type="checkbox" id="backup-chat" checked style="margin-right: 8px;">
                            <span>èŠå¤©è®°å½•</span>
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 8px;">
                            <input type="checkbox" id="backup-transactions" checked style="margin-right: 8px;">
                            <span>äº¤æ˜“è®°å½•</span>
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 8px;">
                            <input type="checkbox" id="backup-books" checked style="margin-right: 8px;">
                            <span>ä¸–ç•Œä¹¦</span>
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 8px;">
                            <input type="checkbox" id="backup-settings" checked style="margin-right: 8px;">
                            <span>è®¾ç½®é…ç½®</span>
                        </label>
                    </div>
                </div>
                <div id="backup-status-container" style="margin-top: 15px; padding: 10px; border-radius: 8px; background: var(--bg);">
                    <div style="font-weight: 500; margin-bottom: 5px;">å¤‡ä»½çŠ¶æ€</div>
                    <div id="backup-status-text">ä¸Šæ¬¡å¤‡ä»½: ä»æœªå¤‡ä»½</div>
                    <div class="progress-bar" style="margin-top: 10px;">
                        <div class="progress-bar-fill" id="backup-progress" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-warning" onclick="restoreBackup()">æ¢å¤å¤‡ä»½</button>
                <button class="btn btn-success" onclick="createBackup()">ç«‹å³å¤‡ä»½</button>
                <button class="btn btn-primary" onclick="saveBackupConfig()">ä¿å­˜é…ç½®</button>
            </div>
        </div>
    </div>

    <!-- å¯¼å…¥/å¯¼å‡ºæ¨¡æ€æ¡† -->
    <div class="modal" id="import-export-modal">
        <div class="modal-content">
            <div class="modal-header">å¯¼å…¥/å¯¼å‡ºæ•°æ®</div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <div style="font-weight: 500; margin-bottom: 10px;">å¯¼å‡ºæ•°æ®</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="settings-button" onclick="exportData('all')">å¯¼å‡ºå…¨éƒ¨æ•°æ®</button>
                        <button class="settings-button secondary" onclick="exportData('settings')">ä»…å¯¼å‡ºè®¾ç½®</button>
                    </div>
                    <div style="margin-top: 10px; font-size: 12px; color: var(--text-secondary);">
                        å¯¼å‡ºæ–‡ä»¶æ ¼å¼: JSON
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <div style="font-weight: 500; margin-bottom: 10px;">å¯¼å…¥æ•°æ®</div>
                    <div class="file-upload">
                        <button class="settings-button">é€‰æ‹©å¯¼å…¥æ–‡ä»¶</button>
                        <input type="file" id="import-file" accept=".json" onchange="handleImportFileSelect(event)">
                    </div>
                    <div id="import-file-info" style="margin-top: 10px; font-size: 12px; color: var(--text-secondary); display: none;">
                        å·²é€‰æ‹©æ–‡ä»¶: <span id="import-file-name"></span>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <div style="font-weight: 500; margin-bottom: 10px;">æ•°æ®ç®¡ç†</div>
                    <div class="settings-row">
                        <button class="settings-button danger" onclick="clearAllData()">æ¸…é™¤æ‰€æœ‰æ•°æ®</button>
                        <button class="settings-button warning" onclick="resetToDefault()">é‡ç½®ä¸ºé»˜è®¤</button>
                    </div>
                </div>
                
                <div>
                    <div style="font-weight: 500; margin-bottom: 10px;">ç³»ç»Ÿè¯Šæ–­</div>
                    <button class="settings-button" onclick="runSystemDiagnostics()">è¿è¡Œç³»ç»Ÿè¯Šæ–­</button>
                    <div id="diagnostics-result" style="margin-top: 10px; padding: 10px; border-radius: 8px; background: var(--bg); font-size: 12px; display: none;">
                        <!-- è¯Šæ–­ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">å…³é—­</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€æ•°æ®
        const appData = {
            balance: 5280.50,
            cart: [],
            transactions: [],
            books: [],
            products: [
                { id: 1, name: 'æ— çº¿è€³æœº', price: 199, icon: 'ğŸ§' },
                { id: 2, name: 'æ™ºèƒ½æ‰‹è¡¨', price: 899, icon: 'âŒš' },
                { id: 3, name: 'ç§»åŠ¨ç”µæº', price: 129, icon: 'ğŸ”‹' },
                { id: 4, name: 'è“ç‰™éŸ³ç®±', price: 299, icon: 'ğŸ”Š' },
                { id: 5, name: 'å¹³æ¿ç”µè„‘', price: 3299, icon: 'ğŸ“±' },
                { id: 6, name: 'æ¸¸æˆæ‰‹æŸ„', price: 399, icon: 'ğŸ®' }
            ],
            aiResponses: [
                "å¥½çš„ï¼Œæˆ‘æ˜ç™½äº†ã€‚",
                "è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼Œè®©æˆ‘ä¸ºæ‚¨è§£ç­”ã€‚",
                "æ ¹æ®æ‚¨æä¾›çš„ä¿¡æ¯ï¼Œæˆ‘å»ºè®®æ‚¨å¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š",
                "æ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜éœ€è¦å¸®åŠ©å—ï¼Ÿ",
                "æœ¬æ¨¡æ‹Ÿå™¨æ”¯æŒAIèŠå¤©ã€è´­ç‰©ã€è®°è´¦ã€ä¸–ç•Œä¹¦ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚",
                "æ‚¨å¯ä»¥å°è¯•ä½¿ç”¨è´­ç‰©åŠŸèƒ½è´­ä¹°è™šæ‹Ÿå•†å“ï¼Œæˆ–è€…ä½¿ç”¨è®°è´¦åŠŸèƒ½ç®¡ç†æ‚¨çš„è´¢åŠ¡ã€‚"
            ],
            settings: {
                darkMode: false,
                apiConfig: {
                    type: 'direct',
                    endpoint: 'https://api.example.com/v1',
                    key: '',
                    timeout: 30,
                    retry: 3,
                    status: 'disconnected'
                },
                ttsConfig: {
                    provider: 'minimax',
                    apiKey: '',
                    model: 'female-1',
                    speed: 1.0,
                    pitch: 1.0
                },
                imageGenConfig: {
                    provider: 'noval-ai',
                    apiKey: '',
                    resolution: '512x512',
                    count: 1,
                    style: 'realistic'
                },
                backupConfig: {
                    service: 'github',
                    repo: '',
                    token: '',
                    frequency: 'manual',
                    includeChat: true,
                    includeTransactions: true,
                    includeBooks: true,
                    includeSettings: true,
                    lastBackup: null
                }
            }
        };

        // åˆå§‹åŒ–æ•°æ®
        function initData() {
            // åˆå§‹åŒ–äº¤æ˜“è®°å½•
            appData.transactions = [
                { type: 'income', amount: 5000, desc: 'å·¥èµ„æ”¶å…¥', time: '2024-01-01' },
                { type: 'expense', amount: 199, desc: 'è´­ä¹°è€³æœº', time: '2024-01-02' },
                { type: 'expense', amount: 299, desc: 'è´­ä¹°éŸ³ç®±', time: '2024-01-03' },
                { type: 'income', amount: 200, desc: 'å…¼èŒæ”¶å…¥', time: '2024-01-04' }
            ];

            // åˆå§‹åŒ–ä¸–ç•Œä¹¦
            appData.books = [
                { name: 'ç§‘å¹»å°è¯´é›†', desc: 'æ”¶å½•ç»å…¸ç§‘å¹»ä½œå“', category: 'å°è¯´', icon: 'ğŸš€' },
                { name: 'ç¼–ç¨‹å…¥é—¨', desc: 'é›¶åŸºç¡€å­¦ä¹ ç¼–ç¨‹', category: 'æ•™è‚²', icon: 'ğŸ’»' },
                { name: 'å†å²ç™¾ç§‘', desc: 'äººç±»æ–‡æ˜å‘å±•å²', category: 'å†å²', icon: 'ğŸ›ï¸' },
                { name: 'äººå·¥æ™ºèƒ½å¯¼è®º', desc: 'AIåŸºç¡€ä¸åº”ç”¨', category: 'ç§‘æŠ€', icon: 'ğŸ¤–' }
            ];

            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½è®¾ç½®
            loadSettings();

            updateCartCount();
            renderTransactions();
            renderProducts();
            renderBooks();
            renderSettings();
        }

        // åŠ è½½è®¾ç½®
        function loadSettings() {
            try {
                const savedSettings = localStorage.getItem('smartphoneSimulatorSettings');
                if (savedSettings) {
                    const parsedSettings = JSON.parse(savedSettings);
                    appData.settings = { ...appData.settings, ...parsedSettings };
                    
                    // åº”ç”¨æš—è‰²æ¨¡å¼
                    if (appData.settings.darkMode) {
                        document.getElementById('phone').classList.add('dark-mode');
                    }
                }
            } catch (error) {
                console.error('åŠ è½½è®¾ç½®å¤±è´¥:', error);
                showNotification('åŠ è½½è®¾ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤è®¾ç½®', 'error');
            }
        }

        // ä¿å­˜è®¾ç½®
        function saveSettings() {
            try {
                localStorage.setItem('smartphoneSimulatorSettings', JSON.stringify(appData.settings));
                showNotification('è®¾ç½®å·²ä¿å­˜', 'success');
            } catch (error) {
                console.error('ä¿å­˜è®¾ç½®å¤±è´¥:', error);
                showNotification('ä¿å­˜è®¾ç½®å¤±è´¥', 'error');
            }
        }

        // æ‰“å¼€åº”ç”¨
        function openApp(appName) {
            // éšè—æ‰€æœ‰å±å¹•
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => {
                screen.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡å±å¹•
            const targetScreen = document.getElementById(`${appName}-screen`);
            if (targetScreen) {
                targetScreen.classList.add('active');
                
                // å¦‚æœæ˜¯è®¾ç½®ç•Œé¢ï¼Œç¡®ä¿å†…å®¹æ˜¯æœ€æ–°çš„
                if (appName === 'settings') {
                    setTimeout(() => {
                        renderSettings();
                    }, 50);
                }
            }
            
            // æ›´æ–°å¯¼èˆªæ¿€æ´»çŠ¶æ€
            updateNavActive(appName);
        }

        function updateNavActive(appName) {
            // ç§»é™¤æ‰€æœ‰å¯¼èˆªé¡¹çš„æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // æ¿€æ´»å¯¹åº”çš„å¯¼èˆªé¡¹
            const targetNav = document.querySelector(`.nav-item[data-nav="${appName}"]`);
            if (targetNav) {
                targetNav.classList.add('active');
            }
        }

        function goHome() {
            openApp('home');
        }

        // å‘é€AIæ¶ˆæ¯
        function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            const messagesDiv = document.getElementById('chat-messages');
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            const userMsg = document.createElement('div');
            userMsg.className = 'message sent';
            userMsg.innerHTML = `
                ${message}
                <div class="message-time">${time}</div>
            `;
            messagesDiv.appendChild(userMsg);
            
            input.value = '';
            input.focus();
            
            // AIå›å¤
            setTimeout(() => {
                const aiResponse = appData.aiResponses[Math.floor(Math.random() * appData.aiResponses.length)];
                const aiMsg = document.createElement('div');
                aiMsg.className = 'message received';
                aiMsg.innerHTML = `
                    ${aiResponse}
                    <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                `;
                messagesDiv.appendChild(aiMsg);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }, 1000);
            
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function sendMessageOnEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
                event.preventDefault();
            }
        }

        // è´­ç‰©åŠŸèƒ½
        function renderProducts() {
            const productsDiv = document.getElementById('products');
            productsDiv.innerHTML = '';
            
            appData.products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'product';
                productDiv.innerHTML = `
                    <div class="product-img">${product.icon}</div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">Â¥${product.price}</div>
                        <button class="add-to-cart" onclick="addToCart(${product.id})">åŠ å…¥è´­ç‰©è½¦</button>
                    </div>
                `;
                productsDiv.appendChild(productDiv);
            });
        }

        function addToCart(productId) {
            const product = appData.products.find(p => p.id === productId);
            if (product) {
                appData.cart.push(product);
                updateCartCount();
                
                showNotification(`å·²æ·»åŠ  ${product.name} åˆ°è´­ç‰©è½¦`, 'success');
            }
        }

        function updateCartCount() {
            document.getElementById('cart-count').textContent = appData.cart.length;
        }

        function viewCart() {
            const cartItemsDiv = document.getElementById('cart-items');
            cartItemsDiv.innerHTML = '';
            
            if (appData.cart.length === 0) {
                cartItemsDiv.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">è´­ç‰©è½¦æ˜¯ç©ºçš„</p>';
            } else {
                let total = 0;
                appData.cart.forEach(item => {
                    total += item.price;
                    const itemDiv = document.createElement('div');
                    itemDiv.style.display = 'flex';
                    itemDiv.style.justifyContent = 'space-between';
                    itemDiv.style.alignItems = 'center';
                    itemDiv.style.padding = '10px 0';
                    itemDiv.style.borderBottom = '1px solid var(--border)';
                    itemDiv.innerHTML = `
                        <div>
                            <div style="font-weight: 500;">${item.name}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">${item.icon}</div>
                        </div>
                        <div style="color: var(--primary); font-weight: bold;">Â¥${item.price}</div>
                    `;
                    cartItemsDiv.appendChild(itemDiv);
                });
                
                const totalDiv = document.createElement('div');
                totalDiv.style.display = 'flex';
                totalDiv.style.justifyContent = 'space-between';
                totalDiv.style.padding = '15px 0';
                totalDiv.style.fontWeight = 'bold';
                totalDiv.style.fontSize = '18px';
                totalDiv.innerHTML = `
                    <span>æ€»è®¡ï¼š</span>
                    <span style="color: var(--primary);">Â¥${total}</span>
                `;
                cartItemsDiv.appendChild(totalDiv);
            }
            
            document.getElementById('cart-modal').style.display = 'flex';
        }

        function checkout() {
            if (appData.cart.length === 0) {
                showNotification('è´­ç‰©è½¦æ˜¯ç©ºçš„', 'warning');
                return;
            }
            
            const total = appData.cart.reduce((sum, item) => sum + item.price, 0);
            
            if (confirm(`ç¡®è®¤ç»“ç®—ï¼Ÿæ€»é‡‘é¢ï¼šÂ¥${total}`)) {
                appData.cart = [];
                updateCartCount();
                closeModal();
                showNotification('è´­ä¹°æˆåŠŸï¼', 'success');
            }
        }

        // è®°è´¦åŠŸèƒ½
        function renderTransactions() {
            const transactionsDiv = document.getElementById('transactions');
            transactionsDiv.innerHTML = '';
            
            appData.transactions.forEach(trans => {
                const transDiv = document.createElement('div');
                transDiv.className = 'transaction';
                transDiv.innerHTML = `
                    <div class="transaction-info">
                        <h4>${trans.desc}</h4>
                        <span>${trans.time}</span>
                    </div>
                    <div class="transaction-amount ${trans.type}">
                        ${trans.type === 'income' ? '+' : '-'}Â¥${trans.amount}
                    </div>
                `;
                transactionsDiv.appendChild(transDiv);
            });
            
            // æ ¼å¼åŒ–ä½™é¢æ˜¾ç¤º
            const formattedBalance = appData.balance.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            document.getElementById('balance').textContent = formattedBalance;
        }

        function addTransaction(type) {
            document.getElementById('transaction-type').value = type;
            document.getElementById('transaction-modal').style.display = 'flex';
            document.getElementById('transaction-amount').focus();
        }

        function saveTransaction() {
            const type = document.getElementById('transaction-type').value;
            const amount = parseFloat(document.getElementById('transaction-amount').value);
            const desc = document.getElementById('transaction-desc').value.trim();
            
            if (!amount || amount <= 0 || !desc) {
                showNotification('è¯·å¡«å†™å®Œæ•´çš„äº¤æ˜“ä¿¡æ¯', 'warning');
                return;
            }
            
            const transaction = {
                type,
                amount,
                desc,
                time: new Date().toLocaleDateString()
            };
            
            appData.transactions.unshift(transaction);
            
            if (type === 'income') {
                appData.balance += amount;
            } else {
                appData.balance -= amount;
            }
            
            renderTransactions();
            closeModal();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('transaction-amount').value = '';
            document.getElementById('transaction-desc').value = '';
            
            showNotification('äº¤æ˜“å·²æ·»åŠ ', 'success');
        }

        // ä¸–ç•Œä¹¦åŠŸèƒ½
        function renderBooks() {
            const booksDiv = document.getElementById('books-list');
            booksDiv.innerHTML = '';
            
            appData.books.forEach(book => {
                const bookDiv = document.createElement('div');
                bookDiv.className = 'book-item';
                bookDiv.innerHTML = `
                    <div class="book-icon">${book.icon}</div>
                    <div class="book-name">${book.name}</div>
                    <div class="book-desc">${book.desc}</div>
                    <div style="margin-top: 8px; font-size: 11px; color: var(--primary);">${book.category}</div>
                `;
                booksDiv.appendChild(bookDiv);
            });
        }

        function addBook() {
            document.getElementById('book-name').value = '';
            document.getElementById('book-desc').value = '';
            document.getElementById('book-modal').style.display = 'flex';
            document.getElementById('book-name').focus();
        }

        function saveBook() {
            const name = document.getElementById('book-name').value.trim();
            const desc = document.getElementById('book-desc').value.trim();
            const category = document.getElementById('book-category').value;
            
            if (!name || !desc) {
                showNotification('è¯·å¡«å†™å®Œæ•´çš„ä¹¦ç±ä¿¡æ¯', 'warning');
                return;
            }
            
            const icons = ['ğŸ“š', 'ğŸ“–', 'ğŸ“˜', 'ğŸ“™', 'ğŸ“•', 'ğŸ“—', 'ğŸ““', 'ğŸ“”', 'ğŸš€', 'ğŸ’»', 'ğŸ›ï¸', 'ğŸ¤–'];
            const randomIcon = icons[Math.floor(Math.random() * icons.length)];
            
            const book = {
                name,
                desc,
                category,
                icon: randomIcon
            };
            
            appData.books.unshift(book);
            renderBooks();
            closeModal();
            showNotification('ä¹¦ç±å·²æ·»åŠ ', 'success');
        }

        // è®¾ç½®åŠŸèƒ½
        function renderSettings() {
            const container = document.getElementById('settings-container');
            container.innerHTML = '';
            
            // 1. å¤–è§‚è®¾ç½®
            const appearanceSection = createSettingsSection('å¤–è§‚è®¾ç½®');
            appearanceSection.appendChild(createToggleSetting(
                'darkModeToggle',
                'æš—è‰²æ¨¡å¼',
                'å¯ç”¨æ·±è‰²ä¸»é¢˜',
                appData.settings.darkMode,
                (checked) => {
                    appData.settings.darkMode = checked;
                    if (checked) {
                        document.getElementById('phone').classList.add('dark-mode');
                    } else {
                        document.getElementById('phone').classList.remove('dark-mode');
                    }
                    saveSettings();
                }
            ));
            
            appearanceSection.appendChild(createSettingsItem(
                'ä¸»é¢˜é¢œè‰²',
                'é€‰æ‹©åº”ç”¨çš„ä¸»è‰²è°ƒ',
                'è‡ªå®šä¹‰',
                () => {
                    showNotification('ä¸»é¢˜é¢œè‰²é€‰æ‹©åŠŸèƒ½å¼€å‘ä¸­', 'info');
                }
            ));
            
            container.appendChild(appearanceSection);
            
            // 2. APIé…ç½®
            const apiSection = createSettingsSection('APIé…ç½®');
            
            const apiStatus = document.createElement('div');
            apiStatus.className = 'settings-item';
            apiStatus.innerHTML = `
                <div class="settings-item-label">
                    <div class="settings-item-name">APIè¿æ¥çŠ¶æ€</div>
                    <div class="settings-item-desc">${getApiStatusText()}</div>
                </div>
                <div class="settings-item-value">
                    <span class="api-status ${appData.settings.apiConfig.status}"></span>
                    ${getApiStatusDisplay()}
                </div>
            `;
            apiSection.appendChild(apiStatus);
            
            apiSection.appendChild(createSettingsItem(
                'APIé…ç½®',
                'é…ç½®AIæœåŠ¡çš„APIè¿æ¥',
                appData.settings.apiConfig.type === 'direct' ? 'ç›´è¿' : 
                appData.settings.apiConfig.type === 'cli' ? 'CLIä»£ç†' : 
                appData.settings.apiConfig.type === 'reverse-proxy' ? 'åå‘ä»£ç†' : 'è‡ªå®šä¹‰',
                () => {
                    openApiConfigModal();
                }
            ));
            
            container.appendChild(apiSection);
            
            // 3. TTSè¯­éŸ³é…ç½®
            const ttsSection = createSettingsSection('TTSè¯­éŸ³é…ç½®');
            ttsSection.appendChild(createSettingsItem(
                'è¯­éŸ³é…ç½®',
                'é…ç½®Minimaxç­‰TTSè¯­éŸ³æœåŠ¡',
                appData.settings.ttsConfig.provider === 'minimax' ? 'Minimax' : 
                appData.settings.ttsConfig.provider === 'azure' ? 'Azure' : 
                appData.settings.ttsConfig.provider === 'google' ? 'Google' : 
                appData.settings.ttsConfig.provider === 'amazon' ? 'Amazon' : 'æœ¬åœ°',
                () => {
                    openTTSConfigModal();
                }
            ));
            
            container.appendChild(ttsSection);
            
            // 4. AIæ–‡ç”Ÿå›¾é…ç½®
            const imageGenSection = createSettingsSection('AIæ–‡ç”Ÿå›¾é…ç½®');
            imageGenSection.appendChild(createSettingsItem(
                'å›¾åƒç”Ÿæˆ',
                'é…ç½®Noval AIã€Nano Bananaç­‰å›¾åƒç”ŸæˆæœåŠ¡',
                appData.settings.imageGenConfig.provider === 'noval-ai' ? 'Noval AI' : 
                appData.settings.imageGenConfig.provider === 'nano-banana' ? 'Nano Banana' : 
                appData.settings.imageGenConfig.provider === 'stable-diffusion' ? 'Stable Diffusion' : 
                appData.settings.imageGenConfig.provider === 'dall-e' ? 'DALL-E' : 'Midjourney',
                () => {
                    openImageGenConfigModal();
                }
            ));
            
            container.appendChild(imageGenSection);
            
            // 5. å¤‡ä»½åŠŸèƒ½
            const backupSection = createSettingsSection('å¤‡ä»½åŠŸèƒ½');
            
            const backupStatus = document.createElement('div');
            backupStatus.className = 'settings-item';
            const lastBackupText = appData.settings.backupConfig.lastBackup 
                ? new Date(appData.settings.backupConfig.lastBackup).toLocaleDateString() 
                : 'ä»æœªå¤‡ä»½';
            backupStatus.innerHTML = `
                <div class="settings-item-label">
                    <div class="settings-item-name">å¤‡ä»½çŠ¶æ€</div>
                    <div class="settings-item-desc">ä¸Šæ¬¡å¤‡ä»½: ${lastBackupText}</div>
                </div>
                <div class="settings-item-value">
                    <span class="backup-status ${appData.settings.backupConfig.lastBackup ? 'success' : 'warning'}">
                        ${appData.settings.backupConfig.lastBackup ? 'å·²å¤‡ä»½' : 'æœªå¤‡ä»½'}
                    </span>
                </div>
            `;
            backupSection.appendChild(backupStatus);
            
            backupSection.appendChild(createSettingsItem(
                'å¤‡ä»½é…ç½®',
                'é…ç½®GitHubç­‰å¤‡ä»½æœåŠ¡',
                appData.settings.backupConfig.service === 'github' ? 'GitHub' : 
                appData.settings.backupConfig.service === 'gitlab' ? 'GitLab' : 
                appData.settings.backupConfig.service === 'dropbox' ? 'Dropbox' : 
                appData.settings.backupConfig.service === 'google-drive' ? 'Google Drive' : 'æœ¬åœ°',
                () => {
                    openBackupConfigModal();
                }
            ));
            
            container.appendChild(backupSection);
            
            // 6. æ•°æ®ç®¡ç†
            const dataSection = createSettingsSection('æ•°æ®ç®¡ç†');
            dataSection.appendChild(createSettingsItem(
                'å¯¼å…¥/å¯¼å‡ºæ•°æ®',
                'å¤‡ä»½æˆ–æ¢å¤åº”ç”¨æ•°æ®',
                'ç®¡ç†',
                () => {
                    openImportExportModal();
                }
            ));
            
            dataSection.appendChild(createSettingsItem(
                'æ¸…ç†ç¼“å­˜',
                'æ¸…é™¤åº”ç”¨ç¼“å­˜å’Œä¸´æ—¶æ•°æ®',
                'æ¸…ç†',
                () => {
                    clearCache();
                }
            ));
            
            dataSection.appendChild(createSettingsItem(
                'é‡ç½®åº”ç”¨',
                'å°†åº”ç”¨é‡ç½®ä¸ºåˆå§‹çŠ¶æ€',
                'é‡ç½®',
                () => {
                    resetApplication();
                }
            ));
            
            container.appendChild(dataSection);
            
            // 7. ç³»ç»Ÿä¿¡æ¯
            const systemSection = createSettingsSection('ç³»ç»Ÿä¿¡æ¯');
            systemSection.appendChild(createSettingsItem(
                'åº”ç”¨ç‰ˆæœ¬',
                'æ™ºèƒ½æ‰‹æœºæ¨¡æ‹Ÿå™¨',
                'v1.0.0'
            ));
            
            systemSection.appendChild(createSettingsItem(
                'å­˜å‚¨ä½¿ç”¨æƒ…å†µ',
                'è®¡ç®—åº”ç”¨æ•°æ®å ç”¨ç©ºé—´',
                'æ£€æŸ¥',
                () => {
                    checkStorageUsage();
                }
            ));
            
            systemSection.appendChild(createSettingsItem(
                'ç³»ç»Ÿè¯Šæ–­',
                'æ£€æŸ¥åº”ç”¨é—®é¢˜å’Œé”™è¯¯',
                'è¿è¡Œè¯Šæ–­',
                () => {
                    runSystemDiagnostics();
                }
            ));
            
            container.appendChild(systemSection);
        }

        function createSettingsSection(title) {
            const section = document.createElement('div');
            section.className = 'settings-section';
            
            const titleDiv = document.createElement('div');
            titleDiv.className = 'settings-section-title';
            titleDiv.textContent = title;
            
            section.appendChild(titleDiv);
            return section;
        }

        function createSettingsItem(name, desc, value, onClick = null) {
            const item = document.createElement('div');
            item.className = 'settings-item';
            
            const html = `
                <div class="settings-item-label">
                    <div class="settings-item-name">${name}</div>
                    <div class="settings-item-desc">${desc}</div>
                </div>
                <div class="settings-item-value">${value}</div>
            `;
            
            item.innerHTML = html;
            
            if (onClick) {
                item.addEventListener('click', onClick);
            }
            
            return item;
        }

        function createToggleSetting(id, name, desc, checked, onChange) {
            const item = document.createElement('div');
            item.className = 'settings-item';
            
            const html = `
                <div class="settings-item-label">
                    <div class="settings-item-name">${name}</div>
                    <div class="settings-item-desc">${desc}</div>
                </div>
                <label class="settings-toggle">
                    <input type="checkbox" id="${id}" ${checked ? 'checked' : ''}>
                    <span class="settings-toggle-slider"></span>
                </label>
            `;
            
            item.innerHTML = html;
            
            const toggle = item.querySelector('input');
            toggle.addEventListener('change', (e) => {
                onChange(e.target.checked);
            });
            
            return item;
        }

        function getApiStatusText() {
            const status = appData.settings.apiConfig.status;
            switch(status) {
                case 'connected': return 'å·²è¿æ¥åˆ°APIæœåŠ¡';
                case 'disconnected': return 'æœªè¿æ¥';
                case 'connecting': return 'æ­£åœ¨è¿æ¥...';
                default: return 'æœªçŸ¥çŠ¶æ€';
            }
        }

        function getApiStatusDisplay() {
            const status = appData.settings.apiConfig.status;
            switch(status) {
                case 'connected': return 'å·²è¿æ¥';
                case 'disconnected': return 'æœªè¿æ¥';
                case 'connecting': return 'è¿æ¥ä¸­';
                default: return 'æœªçŸ¥';
            }
        }

        // APIé…ç½®åŠŸèƒ½
        function openApiConfigModal() {
            const config = appData.settings.apiConfig;
            document.getElementById('api-type').value = config.type;
            document.getElementById('api-endpoint').value = config.endpoint;
            document.getElementById('api-key').value = config.key;
            document.getElementById('api-timeout').value = config.timeout;
            document.getElementById('api-retry').value = config.retry;
            
            updateApiStatusDisplay();
            
            document.getElementById('api-modal').style.display = 'flex';
        }

        function updateApiStatusDisplay() {
            const statusText = document.getElementById('api-status-text');
            const progressBar = document.getElementById('api-progress');
            const status = appData.settings.apiConfig.status;
            
            switch(status) {
                case 'connected':
                    statusText.textContent = 'çŠ¶æ€ï¼šå·²è¿æ¥';
                    statusText.style.color = 'var(--success)';
                    progressBar.style.width = '100%';
                    progressBar.style.backgroundColor = 'var(--success)';
                    break;
                case 'disconnected':
                    statusText.textContent = 'çŠ¶æ€ï¼šæœªè¿æ¥';
                    statusText.style.color = 'var(--danger)';
                    progressBar.style.width = '0%';
                    progressBar.style.backgroundColor = 'var(--danger)';
                    break;
                case 'connecting':
                    statusText.textContent = 'çŠ¶æ€ï¼šæ­£åœ¨è¿æ¥...';
                    statusText.style.color = 'var(--warning)';
                    progressBar.style.width = '50%';
                    progressBar.style.backgroundColor = 'var(--warning)';
                    break;
            }
        }

        function testApiConnection() {
            const endpoint = document.getElementById('api-endpoint').value;
            const key = document.getElementById('api-key').value;
            
            if (!endpoint || !key) {
                showNotification('è¯·å¡«å†™APIç«¯ç‚¹å’Œå¯†é’¥', 'warning');
                return;
            }
            
            // æ¨¡æ‹ŸAPIè¿æ¥æµ‹è¯•
            appData.settings.apiConfig.status = 'connecting';
            updateApiStatusDisplay();
            
            showNotification('æ­£åœ¨æµ‹è¯•APIè¿æ¥...', 'info');
            
            setTimeout(() => {
                // æ¨¡æ‹Ÿè¿æ¥æˆåŠŸï¼ˆå®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥æ˜¯çœŸå®çš„APIè°ƒç”¨ï¼‰
                const success = Math.random() > 0.3; // 70%æˆåŠŸç‡
                
                if (success) {
                    appData.settings.apiConfig.status = 'connected';
                    showNotification('APIè¿æ¥æµ‹è¯•æˆåŠŸ', 'success');
                } else {
                    appData.settings.apiConfig.status = 'disconnected';
                    showNotification('APIè¿æ¥æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®', 'error');
                }
                
                updateApiStatusDisplay();
            }, 1500);
        }

        function saveApiConfig() {
            appData.settings.apiConfig = {
                type: document.getElementById('api-type').value,
                endpoint: document.getElementById('api-endpoint').value,
                key: document.getElementById('api-key').value,
                timeout: parseInt(document.getElementById('api-timeout').value),
                retry: parseInt(document.getElementById('api-retry').value),
                status: appData.settings.apiConfig.status
            };
            
            saveSettings();
            closeModal();
            showNotification('APIé…ç½®å·²ä¿å­˜', 'success');
            
            // æ›´æ–°è®¾ç½®ç•Œé¢
            renderSettings();
        }

        // TTSé…ç½®åŠŸèƒ½
        function openTTSConfigModal() {
            const config = appData.settings.ttsConfig;
            document.getElementById('tts-provider').value = config.provider;
            document.getElementById('tts-api-key').value = config.apiKey;
            document.getElementById('tts-model').value = config.model;
            document.getElementById('tts-speed').value = config.speed;
            document.getElementById('tts-pitch').value = config.pitch;
            document.getElementById('tts-test-text').value = 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­éŸ³æµ‹è¯•ã€‚';
            
            // æ›´æ–°æ»‘å—å€¼æ˜¾ç¤º
            document.getElementById('tts-speed-value').textContent = config.speed;
            document.getElementById('tts-pitch-value').textContent = config.pitch;
            
            // æ·»åŠ æ»‘å—äº‹ä»¶ç›‘å¬
            document.getElementById('tts-speed').addEventListener('input', (e) => {
                document.getElementById('tts-speed-value').textContent = e.target.value;
            });
            
            document.getElementById('tts-pitch').addEventListener('input', (e) => {
                document.getElementById('tts-pitch-value').textContent = e.target.value;
            });
            
            document.getElementById('tts-modal').style.display = 'flex';
        }

        function testTTS() {
            const text = document.getElementById('tts-test-text').value;
            if (!text.trim()) {
                showNotification('è¯·è¾“å…¥æµ‹è¯•æ–‡æœ¬', 'warning');
                return;
            }
            
            showNotification('æ­£åœ¨ç”Ÿæˆè¯­éŸ³...ï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'info');
            
            // æ¨¡æ‹ŸTTSç”Ÿæˆï¼ˆå®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥æ˜¯çœŸå®çš„TTS APIè°ƒç”¨ï¼‰
            setTimeout(() => {
                showNotification('è¯­éŸ³ç”Ÿæˆå®Œæˆï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'success');
                
                // åœ¨æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬æ— æ³•å®é™…æ’­æ”¾éŸ³é¢‘ï¼Œä½†å¯ä»¥æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                // å®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥æ’­æ”¾ç”Ÿæˆçš„éŸ³é¢‘
            }, 1000);
        }

        function saveTTSConfig() {
            appData.settings.ttsConfig = {
                provider: document.getElementById('tts-provider').value,
                apiKey: document.getElementById('tts-api-key').value,
                model: document.getElementById('tts-model').value,
                speed: parseFloat(document.getElementById('tts-speed').value),
                pitch: parseFloat(document.getElementById('tts-pitch').value)
            };
            
            saveSettings();
            closeModal();
            showNotification('TTSé…ç½®å·²ä¿å­˜', 'success');
            
            // æ›´æ–°è®¾ç½®ç•Œé¢
            renderSettings();
        }

        // AIæ–‡ç”Ÿå›¾é…ç½®åŠŸèƒ½
        function openImageGenConfigModal() {
            const config = appData.settings.imageGenConfig;
            document.getElementById('image-gen-provider').value = config.provider;
            document.getElementById('image-gen-api-key').value = config.apiKey;
            document.getElementById('image-gen-resolution').value = config.resolution;
            document.getElementById('image-gen-count').value = config.count;
            document.getElementById('image-gen-style').value = config.style;
            document.getElementById('image-gen-test-prompt').value = 'ä¸€åªå¯çˆ±çš„çŒ«åœ¨èŠ±å›­é‡Œç©è€';
            
            document.getElementById('image-gen-modal').style.display = 'flex';
        }

        function clearImagePreview() {
            const preview = document.getElementById('image-gen-preview');
            preview.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary);">
                    <div>ğŸ–¼ï¸</div>
                    <div>ç”Ÿæˆçš„å›¾åƒå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
                </div>
            `;
        }

        function testImageGeneration() {
            const prompt = document.getElementById('image-gen-test-prompt').value;
            if (!prompt.trim()) {
                showNotification('è¯·è¾“å…¥æµ‹è¯•æç¤ºè¯', 'warning');
                return;
            }
            
            showNotification('æ­£åœ¨ç”Ÿæˆå›¾åƒ...ï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'info');
            
            // æ¨¡æ‹Ÿå›¾åƒç”Ÿæˆï¼ˆå®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥æ˜¯çœŸå®çš„å›¾åƒç”ŸæˆAPIè°ƒç”¨ï¼‰
            const preview = document.getElementById('image-gen-preview');
            preview.innerHTML = '<div class="loading" style="margin: auto;"></div>';
            
            setTimeout(() => {
                // åœ¨æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬æ˜¾ç¤ºä¸€ä¸ªæ¨¡æ‹Ÿçš„å›¾åƒ
                preview.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ–¼ï¸</div>
                        <div>å›¾åƒç”Ÿæˆå®Œæˆï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰</div>
                        <div style="font-size: 12px; margin-top: 5px;">æç¤ºè¯: "${prompt}"</div>
                    </div>
                `;
                
                showNotification('å›¾åƒç”Ÿæˆå®Œæˆï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'success');
            }, 2000);
        }

        function saveImageGenConfig() {
            appData.settings.imageGenConfig = {
                provider: document.getElementById('image-gen-provider').value,
                apiKey: document.getElementById('image-gen-api-key').value,
                resolution: document.getElementById('image-gen-resolution').value,
                count: parseInt(document.getElementById('image-gen-count').value),
                style: document.getElementById('image-gen-style').value
            };
            
            saveSettings();
            closeModal();
            showNotification('å›¾åƒç”Ÿæˆé…ç½®å·²ä¿å­˜', 'success');
            
            // æ›´æ–°è®¾ç½®ç•Œé¢
            renderSettings();
        }

        // å¤‡ä»½é…ç½®åŠŸèƒ½
        function openBackupConfigModal() {
            const config = appData.settings.backupConfig;
            document.getElementById('backup-service').value = config.service;
            document.getElementById('backup-repo').value = config.repo;
            document.getElementById('backup-token').value = config.token;
            document.getElementById('backup-frequency').value = config.frequency;
            document.getElementById('backup-chat').checked = config.includeChat;
            document.getElementById('backup-transactions').checked = config.includeTransactions;
            document.getElementById('backup-books').checked = config.includeBooks;
            document.getElementById('backup-settings').checked = config.includeSettings;
            
            // æ›´æ–°å¤‡ä»½çŠ¶æ€æ˜¾ç¤º
            updateBackupStatusDisplay();
            
            document.getElementById('backup-modal').style.display = 'flex';
        }

        function updateBackupStatusDisplay() {
            const statusText = document.getElementById('backup-status-text');
            const progressBar = document.getElementById('backup-progress');
            const lastBackup = appData.settings.backupConfig.lastBackup;
            
            if (lastBackup) {
                const date = new Date(lastBackup);
                statusText.textContent = `ä¸Šæ¬¡å¤‡ä»½: ${date.toLocaleDateString()} ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
                progressBar.style.width = '100%';
                progressBar.style.backgroundColor = 'var(--success)';
            } else {
                statusText.textContent = 'ä¸Šæ¬¡å¤‡ä»½: ä»æœªå¤‡ä»½';
                progressBar.style.width = '0%';
                progressBar.style.backgroundColor = 'var(--warning)';
            }
        }

        function createBackup() {
            const service = document.getElementById('backup-service').value;
            const repo = document.getElementById('backup-repo').value;
            const token = document.getElementById('backup-token').value;
            
            if (!repo || !token) {
                showNotification('è¯·å¡«å†™ä»“åº“/æ–‡ä»¶å¤¹åç§°å’Œè®¿é—®ä»¤ç‰Œ', 'warning');
                return;
            }
            
            showNotification('æ­£åœ¨åˆ›å»ºå¤‡ä»½...ï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'info');
            
            // æ¨¡æ‹Ÿå¤‡ä»½è¿‡ç¨‹
            const progressBar = document.getElementById('backup-progress');
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    // ä¿å­˜å¤‡ä»½æ—¶é—´
                    appData.settings.backupConfig.lastBackup = new Date().toISOString();
                    saveSettings();
                    
                    updateBackupStatusDisplay();
                    showNotification('å¤‡ä»½åˆ›å»ºæˆåŠŸï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'success');
                }
            }, 200);
        }

        function restoreBackup() {
            showNotification('æ­£åœ¨æ¢å¤å¤‡ä»½...ï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'info');
            
            // æ¨¡æ‹Ÿæ¢å¤è¿‡ç¨‹
            setTimeout(() => {
                showNotification('å¤‡ä»½æ¢å¤æˆåŠŸï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰', 'success');
            }, 1500);
        }

        function saveBackupConfig() {
            appData.settings.backupConfig = {
                service: document.getElementById('backup-service').value,
                repo: document.getElementById('backup-repo').value,
                token: document.getElementById('backup-token').value,
                frequency: document.getElementById('backup-frequency').value,
                includeChat: document.getElementById('backup-chat').checked,
                includeTransactions: document.getElementById('backup-transactions').checked,
                includeBooks: document.getElementById('backup-books').checked,
                includeSettings: document.getElementById('backup-settings').checked,
                lastBackup: appData.settings.backupConfig.lastBackup
            };
            
            saveSettings();
            closeModal();
            showNotification('å¤‡ä»½é…ç½®å·²ä¿å­˜', 'success');
            
            // æ›´æ–°è®¾ç½®ç•Œé¢
            renderSettings();
        }

        // å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½
        function openImportExportModal() {
            document.getElementById('import-export-modal').style.display = 'flex';
        }

        function exportData(type) {
            let data = {};
            
            if (type === 'all') {
                data = {
                    transactions: appData.transactions,
                    books: appData.books,
                    cart: appData.cart,
                    settings: appData.settings,
                    balance: appData.balance,
                    exportDate: new Date().toISOString()
                };
            } else if (type === 'settings') {
                data = {
                    settings: appData.settings,
                    exportDate: new Date().toISOString()
                };
            }
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `smartphone-simulator-${type}-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification(`æ•°æ®å·²å¯¼å‡ºä¸º${type === 'all' ? 'å…¨éƒ¨æ•°æ®' : 'è®¾ç½®'}`, 'success');
        }

        function handleImportFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const fileName = document.getElementById('import-file-name');
            const fileInfo = document.getElementById('import-file-info');
            
            fileName.textContent = file.name;
            fileInfo.style.display = 'block';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (confirm('ç¡®å®šè¦å¯¼å…¥æ•°æ®å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚')) {
                        importData(data);
                    }
                } catch (error) {
                    showNotification('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·é€‰æ‹©æœ‰æ•ˆçš„JSONæ–‡ä»¶', 'error');
                }
            };
            reader.readAsText(file);
        }

        function importData(data) {
            try {
                if (data.transactions) appData.transactions = data.transactions;
                if (data.books) appData.books = data.books;
                if (data.cart) appData.cart = data.cart;
                if (data.settings) appData.settings = { ...appData.settings, ...data.settings };
                if (data.balance) appData.balance = data.balance;
                
                // æ›´æ–°UI
                updateCartCount();
                renderTransactions();
                renderBooks();
                renderSettings();
                
                // åº”ç”¨æš—è‰²æ¨¡å¼
                if (appData.settings.darkMode) {
                    document.getElementById('phone').classList.add('dark-mode');
                } else {
                    document.getElementById('phone').classList.remove('dark-mode');
                }
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                saveSettings();
                
                showNotification('æ•°æ®å¯¼å…¥æˆåŠŸ', 'success');
            } catch (error) {
                showNotification('æ•°æ®å¯¼å…¥å¤±è´¥: ' + error.message, 'error');
            }
        }

        function clearAllData() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                // æ¸…é™¤æ‰€æœ‰æ•°æ®
                appData.transactions = [];
                appData.books = [];
                appData.cart = [];
                appData.balance = 0;
                
                // é‡ç½®è®¾ç½®
                appData.settings = {
                    darkMode: false,
                    apiConfig: {
                        type: 'direct',
                        endpoint: 'https://api.example.com/v1',
                        key: '',
                        timeout: 30,
                        retry: 3,
                        status: 'disconnected'
                    },
                    ttsConfig: {
                        provider: 'minimax',
                        apiKey: '',
                        model: 'female-1',
                        speed: 1.0,
                        pitch: 1.0
                    },
                    imageGenConfig: {
                        provider: 'noval-ai',
                        apiKey: '',
                        resolution: '512x512',
                        count: 1,
                        style: 'realistic'
                    },
                    backupConfig: {
                        service: 'github',
                        repo: '',
                        token: '',
                        frequency: 'manual',
                        includeChat: true,
                        includeTransactions: true,
                        includeBooks: true,
                        includeSettings: true,
                        lastBackup: null
                    }
                };
                
                // æ›´æ–°UI
                updateCartCount();
                renderTransactions();
                renderBooks();
                renderSettings();
                
                // ç§»é™¤æš—è‰²æ¨¡å¼
                document.getElementById('phone').classList.remove('dark-mode');
                
                // æ¸…é™¤æœ¬åœ°å­˜å‚¨
                localStorage.removeItem('smartphoneSimulatorSettings');
                
                showNotification('æ‰€æœ‰æ•°æ®å·²æ¸…é™¤', 'success');
            }
        }

        function resetToDefault() {
            if (confirm('ç¡®å®šè¦é‡ç½®åº”ç”¨ä¸ºé»˜è®¤è®¾ç½®å—ï¼Ÿæ­¤æ“ä½œå°†æ¸…é™¤æ‰€æœ‰è‡ªå®šä¹‰è®¾ç½®ã€‚')) {
                // é‡ç½®è®¾ç½®
                appData.settings = {
                    darkMode: false,
                    apiConfig: {
                        type: 'direct',
                        endpoint: 'https://api.example.com/v1',
                        key: '',
                        timeout: 30,
                        retry: 3,
                        status: 'disconnected'
                    },
                    ttsConfig: {
                        provider: 'minimax',
                        apiKey: '',
                        model: 'female-1',
                        speed: 1.0,
                        pitch: 1.0
                    },
                    imageGenConfig: {
                        provider: 'noval-ai',
                        apiKey: '',
                        resolution: '512x512',
                        count: 1,
                        style: 'realistic'
                    },
                    backupConfig: {
                        service: 'github',
                        repo: '',
                        token: '',
                        frequency: 'manual',
                        includeChat: true,
                        includeTransactions: true,
                        includeBooks: true,
                        includeSettings: true,
                        lastBackup: null
                    }
                };
                
                // æ›´æ–°UI
                renderSettings();
                
                // ç§»é™¤æš—è‰²æ¨¡å¼
                document.getElementById('phone').classList.remove('dark-mode');
                
                // ä¿å­˜è®¾ç½®
                saveSettings();
                
                showNotification('åº”ç”¨å·²é‡ç½®ä¸ºé»˜è®¤è®¾ç½®', 'success');
            }
        }

        function runSystemDiagnostics() {
            const resultDiv = document.getElementById('diagnostics-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading" style="margin: auto;"></div>';
            
            setTimeout(() => {
                const issues = [];
                const warnings = [];
                const successes = [];
                
                // æ£€æŸ¥æœ¬åœ°å­˜å‚¨
                try {
                    localStorage.setItem('test', 'test');
                    localStorage.removeItem('test');
                    successes.push('æœ¬åœ°å­˜å‚¨: æ­£å¸¸');
                } catch (e) {
                    issues.push('æœ¬åœ°å­˜å‚¨: ä¸å¯ç”¨');
                }
                
                // æ£€æŸ¥è®¾ç½®
                if (appData.settings.apiConfig.endpoint === 'https://api.example.com/v1') {
                    warnings.push('APIé…ç½®: ä½¿ç”¨é»˜è®¤ç«¯ç‚¹ï¼Œè¯·é…ç½®æ‚¨çš„APIç«¯ç‚¹');
                } else {
                    successes.push('APIé…ç½®: å·²é…ç½®');
                }
                
                // æ£€æŸ¥æ•°æ®
                if (appData.transactions.length === 0) {
                    warnings.push('äº¤æ˜“æ•°æ®: æ— äº¤æ˜“è®°å½•');
                } else {
                    successes.push(`äº¤æ˜“æ•°æ®: ${appData.transactions.length} æ¡è®°å½•`);
                }
                
                if (appData.books.length === 0) {
                    warnings.push('ä¹¦ç±æ•°æ®: æ— ä¹¦ç±è®°å½•');
                } else {
                    successes.push(`ä¹¦ç±æ•°æ®: ${appData.books.length} æ¡è®°å½•`);
                }
                
                // ç”ŸæˆæŠ¥å‘Š
                let report = '<div style="font-weight: 500; margin-bottom: 10px;">ç³»ç»Ÿè¯Šæ–­æŠ¥å‘Š</div>';
                
                if (issues.length > 0) {
                    report += '<div style="color: var(--danger); margin-bottom: 8px;">';
                    report += '<div style="font-weight: 500;">é—®é¢˜:</div>';
                    issues.forEach(issue => {
                        report += `<div>â€¢ ${issue}</div>`;
                    });
                    report += '</div>';
                }
                
                if (warnings.length > 0) {
                    report += '<div style="color: var(--warning); margin-bottom: 8px;">';
                    report += '<div style="font-weight: 500;">è­¦å‘Š:</div>';
                    warnings.forEach(warning => {
                        report += `<div>â€¢ ${warning}</div>`;
                    });
                    report += '</div>';
                }
                
                if (successes.length > 0) {
                    report += '<div style="color: var(--success);">';
                    report += '<div style="font-weight: 500;">æ­£å¸¸:</div>';
                    successes.forEach(success => {
                        report += `<div>â€¢ ${success}</div>`;
                    });
                    report += '</div>';
                }
                
                resultDiv.innerHTML = report;
            }, 1000);
        }

        // æ¸…ç†ç¼“å­˜
        function clearCache() {
            if (confirm('ç¡®å®šè¦æ¸…ç†åº”ç”¨ç¼“å­˜å—ï¼Ÿ')) {
                // æ¨¡æ‹Ÿæ¸…ç†ç¼“å­˜
                showNotification('æ­£åœ¨æ¸…ç†ç¼“å­˜...', 'info');
                
                setTimeout(() => {
                    showNotification('ç¼“å­˜æ¸…ç†å®Œæˆ', 'success');
                }, 1000);
            }
        }

        // é‡ç½®åº”ç”¨
        function resetApplication() {
            if (confirm('ç¡®å®šè¦é‡ç½®åº”ç”¨å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰æ•°æ®å¹¶æ¢å¤é»˜è®¤è®¾ç½®ã€‚')) {
                clearAllData();
                
                // æ·»åŠ ä¸€äº›é»˜è®¤æ•°æ®
                initData();
                
                showNotification('åº”ç”¨å·²é‡ç½®', 'success');
            }
        }

        // æ£€æŸ¥å­˜å‚¨ä½¿ç”¨æƒ…å†µ
        function checkStorageUsage() {
            try {
                let totalSize = 0;
                
                // è®¡ç®—äº¤æ˜“æ•°æ®å¤§å°
                totalSize += JSON.stringify(appData.transactions).length;
                
                // è®¡ç®—ä¹¦ç±æ•°æ®å¤§å°
                totalSize += JSON.stringify(appData.books).length;
                
                // è®¡ç®—è´­ç‰©è½¦æ•°æ®å¤§å°
                totalSize += JSON.stringify(appData.cart).length;
                
                // è®¡ç®—è®¾ç½®æ•°æ®å¤§å°
                totalSize += JSON.stringify(appData.settings).length;
                
                // è½¬æ¢ä¸ºKB
                const sizeKB = (totalSize / 1024).toFixed(2);
                
                showNotification(`å­˜å‚¨ä½¿ç”¨æƒ…å†µ: ${sizeKB} KB`, 'info');
            } catch (error) {
                showNotification('æ— æ³•è®¡ç®—å­˜å‚¨ä½¿ç”¨æƒ…å†µ', 'error');
            }
        }

        // æ¨¡æ€æ¡†æ§åˆ¶
        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            // ç§»é™¤ç°æœ‰çš„é€šçŸ¥
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            });
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <span>${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸'}</span>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initData();
            
            // ä¸ºåº”ç”¨å›¾æ ‡æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆäº‹ä»¶å§”æ‰˜ï¼‰
            document.querySelector('.app-grid').addEventListener('click', function(event) {
                let target = event.target;
                while (target && !target.classList.contains('app')) {
                    target = target.parentElement;
                    if (target && target.classList.contains('app-grid')) {
                        target = null;
                        break;
                    }
                }
                
                if (target && target.dataset.app) {
                    openApp(target.dataset.app);
                }
            });
            
            // ä¸ºåº•éƒ¨å¯¼èˆªæ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelector('.bottom-nav').addEventListener('click', function(event) {
                let target = event.target;
                while (target && !target.classList.contains('nav-item')) {
                    target = target.parentElement;
                    if (target && target.classList.contains('bottom-nav')) {
                        target = null;
                        break;
                    }
                }
                
                if (target && target.dataset.nav) {
                    openApp(target.dataset.nav);
                }
            });
            
            // æ›´æ–°æ—¶é—´
            function updateTime() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                document.querySelector('.time').textContent = timeStr;
            }
            
            updateTime();
            setInterval(updateTime, 60000);
            
            // ç”µæ± æ¨¡æ‹Ÿ
            let battery = 80;
            const batteryFill = document.querySelector('.battery-fill');
            const batteryText = document.querySelector('.battery span');
            
            function updateBattery() {
                battery -= 0.1;
                if (battery < 0) battery = 100; // æ¨¡æ‹Ÿå……ç”µ
                
                batteryText.textContent = Math.round(battery) + '%';
                batteryFill.style.width = battery + '%';
                batteryFill.style.background = battery > 20 ? 'white' : '#ff3b30';
            }
            
            setInterval(updateBattery, 30000);
            
            // ç‚¹å‡»å¤–éƒ¨å…³é—­æ¨¡æ€æ¡†
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        closeModal();
                    }
                });
            });
            
            // é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>
